<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Word search game</title>
  <link rel="stylesheet" href="css/wordsearch.css"/>
  <link rel="stylesheet" href="css/style.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <link rel="stylesheet" href="../../css/common.scss">
  <meta name="theme-color" content="#fafafa">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/petite-vue/0.4.1/petite-vue.umd.js"></script>
</head>
<body>

<div class="container" id="app" v-scope @vue:mounted="onMounted">
  <div id="splash" class="animate__animated" :class="screen === 'splash' ? animateIn : animateOut">
    <div class="game-content">
      <div class="game-bg">
        <img src="./assets/splash.png" class="responsive-img" alt="splash screen">
        <div class="button" >
          <div class="generic-button" @click="screen = 'instructions'; showInstructions = true">
            <div class="spot-counter-text">How to play</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="instructions" class="animate__animated" v-show="showInstructions"
  :class="screen === 'instructions' ? animateIn : animateOut">
    <div class="game-content">
      <div class="game-bg">
        <div class="header">
          <img src="./assets/heading.png" class="responsive-img" alt="splash screen">
        </div>
        <div class="bodytext">
          <p>How to Play:
          <ol>
          <li>The game starts with 10 words hidden in a grid of letters.</li>
          <li>Words are hidden vertically, horizontally and diagonally.</li>
          <li>Find each word listed at the top.</li>
          <li>Find a word? Tap and drag to colour it in.</li>
          <li>The game ends when all 10 words are found.</li>
          </ol>
        </div>
        <div class="button" >
          <div class="generic-button" @click="screen = 'game'; showGame = true">
            <div class="spot-counter-text">Start Game</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="game" class="animate__animated" v-show="showGame" :class="screen === 'game' ? animateIn : animateOut">
    <section id="ws-area"></section>
    <ul class="ws-words"></ul>
    <div style="display: flex; justify-content: space-between">
      <div class="spot-counter" @click="screen = 'instructions'">
        <div class="spot-counter-text">How to play</div>
      </div>
      <div class="word-list">
        <div class="word-container" v-for="word in wordList">
          {{word}}
        </div>
      </div>
    </div>
  </div>
  <div id="thanks" class="animate__animated" v-show="showThanks" :class="screen === 'thanks' ? animateIn : animateOut">
    <div class="game-content">
      <div class="game-bg">
        <div class="header">
          Thanks for playing
        </div>
        <div class="bodytext">
          <p>lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
          <p>lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
          <p>lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
          <p>lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
        </div>
        <div class="button">
          <button @click="screen = 'game'">Play again</button>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="module" lang="ts">
  PetiteVue.createApp({
    screen: 'splash',
    itemsTotal: 0,
    itemsFound: 0,
    screenWidth: 0,
    animateIn: 'animate__rollIn',
    animateOut: 'animate__rollOut',
    showGame: false,
    showThanks: false,
    showInstructions: false,
    wordList: [],
    onMounted() {

      window.addEventListener("message", (event) => {
        if (event.data === 'ws-done') {
          setTimeout(() => {
            this.showThanks = true;
            this.screen = 'thanks';
          }, 1200);
        }
      })

      fetch("http://99dev.co.za/ls-22/c.json")
        .then(response => response.json())
        .then(data => {
          let gameAreaEl = document.getElementById('ws-area');
          this.wordList = data['word']['wordlist'];
          let gameobj = gameAreaEl.wordSearch({words: data['word']['wordlist'], gridSize: data['word']['gridSize']});
        })
      window.parent.postMessage('ready')
    },

    convertScreenSpaceToPixels(percent) {
      return this.screenWidth * percent / 100;
    }

  }).mount('#app')
</script>

<script src="js/utility.js"></script>
<script src="js/wordsearch.js"></script>
<script src="js/modernizr-custom.js"></script>
<script type="text/javascript">




</script>
</body>
</html>
